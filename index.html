<html>
<head>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style>
	body { font-family: "Open Sans"; }
	div { margin: 30px; }
	svg { background-color: #eee; }
	.axis path { fill: none; stroke: black; }
	.axis line { stroke: black; }
	.axis text { font-size: 10pt; }
	path.outline { fill: none; stroke-width: 5; stroke: white; }
	path.plot { fill: none; stroke-width: 3; }
	</style>
</head>
<body>
<h3>INFO 3300 Homework 3</h3>

<h3>Question 1</h3>
<svg id="q1" height="200" width="200"></svg>

<div>
The graph for Q1 can be seen above
</div>
<div>
<script>
		
var svg = d3.select("#q1");
var height = svg.attr("height");
var width = svg.attr("width");

var padding = 40;
var xScale = d3.scale.linear().domain([1, 9]).range([padding, width - padding]);
var yScale = d3.scale.linear().domain([1, 80]).range([height - padding, 0+padding]);

var xAxis = d3.svg.axis().scale(xScale).orient("bottom").ticks(9).tickFormat("");
var yAxis = d3.svg.axis().scale(yScale).orient("left").tickFormat("");

var changeColor = function(c) {
	return function() {
		d3.select(this).style("fill","blue");
	}
}

svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis")
.call(xAxis);
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis")
.call(yAxis);
svg.append("text").attr("x",0).attr("y",105).text("C");
svg.append("text").attr("x",95).attr("y",180).text("A"); 
svg.append("circle").attr("cx",xScale(2)).attr("cy",yScale(4)).attr("r",3).on("click", changeColor(this));
svg.append("circle").attr("cx",xScale(1)).attr("cy",yScale(1)).attr("r",3).on("click", changeColor(this));
svg.append("rect").attr("x",xScale(4)).attr("y",yScale(15)).attr("width",5).attr("height",5).on("click", changeColor(this));
svg.append("rect").attr("x",xScale(9)).attr("y",yScale(80)).attr("width",5).attr("height",5).on("click", changeColor(this));
</script>
</div>

<h3>Question 3</h3>
<svg id="q3" height="200" width="800"></svg>

<div>
The graph for Q3 can be seen above; it hits the rectangle at time = 10 but I simulated it up to 10.2 to make the distinction much more explicit. In addition, (x0,y0) = (0,1) despite what it looks like in the graph; feel free to check in the source code!
</div>
<script>
		
var svg = d3.select("#q3");
var height = svg.attr("height");
var width = svg.attr("width");

var padding = 40;
var xScale = d3.scale.linear().domain([0, 200]).range([padding, width - padding]);
var yScale = d3.scale.linear().domain([0, 100]).range([height - padding, 0+padding]);

var xAxis = d3.svg.axis().scale(xScale).orient("bottom");
var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(5);

var estimatedTimeOfArrival = 10.2; //it hits at 10 but I just made it 10.2 to be more explicit
var times = []
for(var i = 0; i <= estimatedTimeOfArrival; i +=0.2) {
	times.push(i);
}

function getdX(x,time) {
	var radian = Math.atan(5.2/19);
	var velocity = 19 / Math.cos(radian);

	return velocity*Math.cos(radian)*time-x; 
}

function getdY(y,time) {
	var radian = Math.atan((2+50*9.81)/190);
	var velocity = 19 / Math.cos(radian);
    return velocity*Math.sin(radian)*time - 0.5 * 9.81 * Math.pow(time,2)-y; 
}


svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis")
.call(xAxis);
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis")
.call(yAxis);
svg.append("rect").attr("x",xScale(190)).attr("y",yScale(3)).attr("width",xScale(6)-xScale(0)).attr("height",yScale(0)-yScale(3));

var x = 0; //x0 = 0 
var y = 1; //y0 = 1 
var trajectoryLine = d3.svg.line().x(function (d) { 
		x = x+getdX(x,d);
		return xScale(x);
	}).y(function(d) {
		y = y+getdY(y,d);
		return yScale(y);
	});
svg.append("path").attr("d", trajectoryLine(times)).attr("class","plot").attr("stroke","red").attr("stroke-width", 5).attr("opacity",0.25);

</script>
</div>

<h3>Question 4</h3>
<div id="map"></div>

<script>

var width = 960;
var height = 500;

//var projection = d3.geo.mercator();
var projection = d3.geo.equirectangular();
var path = d3.geo.path().projection(projection);
	
var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);
var g = svg.append("g");
var worldObjects;

d3.json("world-50m.json", function(error, world) {
	worldObjects = world;
	
	if (error) { console.log("callback function") } ;

	var countries = topojson.feature(world, world.objects.countries).features;

	countries.forEach( function (country) {
		g.append("path").attr("d", path(country)).style("fill","#ccc").style("stroke","#888");
	});

	var ithacaCoords = projection([-76,42]);
	g.append("circle").attr("cx", ithacaCoords[0]).attr("cy", ithacaCoords[1]).attr("r",4);
	g.append("text").attr("x",ithacaCoords[0]+5).attr("y",ithacaCoords[1]).text("Cornell University").style("font-size","8px");

	var mcleanCoords = projection([-77.1753,38.9283]);
	g.append("circle").attr("cx", mcleanCoords[0]).attr("cy", mcleanCoords[1]).attr("r",4);
	g.append("text").attr("x", mcleanCoords[0]+5).attr("y", mcleanCoords[1]).text("McLean, Virginia").style("font-size","8px");

	var koreaCoords = projection([126.9667, 37.5667]);
	g.append("circle").attr("cx", koreaCoords[0]).attr("cy", koreaCoords[1]).attr("r",4);
	g.append("text").attr("x", koreaCoords[0]+5).attr("y", koreaCoords[1]).text("Seoul, South Korea").style("font-size","8px");

	g.selectAll("path").data(countries).on("mouseover", function (country) {
		console.log(country.id);
	});
});

	

</script>

<h3>Question 2A</h3>
<svg id="q2a" height="200" width="200"></svg>

<div>
The graph for Q2A can be seen above. The visualization is NOT very useful as most of the words are jumbled together, as a consequence of the relationship between the rank and frequency of the word being inversely proportional (captured by a phenomena known as Zipf's law). </div>
</div>
<h3>Question 2B</h3>
<svg id="q2b" height="200" width="200"></svg>
<div>
	The relation between the log of the rank and the log of the frequency is linear for the above graph.
</div>
<h3>Question 2C</h3>
<svg id="q2c" height="200" width="200"></svg>
</div>
<script>

var wordRanks = [{rank: 1, count: 15342397280, word: "of"},
{rank: 2, count: 7611765281, word: "in"},
{rank: 4, count: 11021132912, word: "and"},
{rank: 8, count: 3021925527, word: "for"},
{rank: 16, count: 1562321315, word: "at"},
{rank: 32, count: 746702714, word: "more"},
{rank: 64, count: 652703221, word: "its"},
{rank: 128, count: 186584246, word: "different"},
{rank: 256, count: 102237666, word: "light"},
{rank: 512, count: 44824164, word: "middle"},
{rank: 1024, count: 34340679, word: "additional"},
{rank: 2048, count: 11864923, word: "abandoned"},
{rank: 4096, count: 7506730, word: "motive"},
{rank: 8192, count: 10615754, word: "Die"},
{rank: 16384, count: 907890, word: "portrays"},
{rank: 32768, count: 226851, word: "Fundamentally"},
{rank: 65536, count: 144913, word: "dv"}];
		
var svg = d3.select("#q2a");
var height = svg.attr("height");
var width = svg.attr("width");

var padding = 50;
var xScale = d3.scale.linear().domain([1, 80000]).range([padding, width - padding]);
var yScale = d3.scale.linear().domain([1, 16000000000]).range([height - padding, 0+padding]);

function adjust(c) {
	var prefix = d3.formatPrefix(c);
	return prefix.scale(c).toFixed()+prefix.symbol;
};

var xAxis = d3.svg.axis().scale(xScale).orient("bottom").ticks(3).tickFormat(function(c) { return adjust(c)});
var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(10).tickFormat(function(c) { return adjust(c)});

svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis")
.call(xAxis);
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis")
.call(yAxis);

wordRanks.forEach(function(point) {
	svg.append("text").attr("x",xScale(point.rank)).attr("y",yScale(point.count)).text(point.word).style("font-size","8px");
});
</script>
<script>
var svg = d3.select("#q2b");
var height = svg.attr("height");
var width = svg.attr("width");

var padding = 50;
var xScale = d3.scale.linear().domain([Math.log(1), Math.log(80000)]).range([padding, width - padding]);
var yScale = d3.scale.linear().domain([Math.log(1), Math.ceil(Math.log(16000000000))]).range([height - padding, 0+padding]);

var xAxis = d3.svg.axis().scale(xScale).orient("bottom").ticks(5);
var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(9);

svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis")
.call(xAxis);
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis")
.call(yAxis);

wordRanks.forEach(function(point) {
	svg.append("text").attr("x",xScale(Math.log(point.rank))).attr("y",yScale(Math.log(point.count))).text(point.word).style("font-size","8px");
});
</script>
</div>
<div>
<script>
var svg = d3.select("#q2c");
var height = svg.attr("height");
var width = svg.attr("width");

var padding = 50;
var xScale = d3.scale.log().domain([1, 80000]).range([padding, width - padding]);
var yScale = d3.scale.log().domain([1, 16000000000]).range([height - padding, 0+padding]);

var xAxis = d3.svg.axis().scale(xScale).orient("bottom").ticks(5);
var yAxis = d3.svg.axis().scale(yScale).orient("left").ticks(9);

svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis")
.call(xAxis);
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis")
.call(yAxis);

wordRanks.forEach(function(point) {
	svg.append("text").attr("x",xScale(point.rank)).attr("y",yScale(point.count)).text(point.word).style("font-size","8px");
});
</script>
</div>

</body>
</html>
